#!/bin/sh
cd ~/lhplain
echo '% This file was automatically generated - do not edit' >omfonts.map
sed 's/cm\(.*\) C.*/om\1 SF\U\1\E "OMEncoding ReEncodeFont" <cm-super-om.enc <sf\1.pfb/' super.map >>omfonts.map
sed -i '/^omtex/{s/SFTEX/SFTT/;s/<sftex/<sftt/}' omfonts.map
cd /tmp
rm -fr vf
mkdir vf
cd vf
rm -fr ~/lhplain/vf ~/lhplain/tfm
mkdir ~/lhplain/vf ~/lhplain/tfm
for cm in `grep -o '^\w\+' ~/lhplain/super.map`; do ##############################
om=$(sed -n "s/^$cm C\(.*\) .*\w\+/o\L\1/p" ~/lhplain/super.map)
tftopl ~/tex/TeXfonts/$om.tfm >$om.vpl
sed -i "1i\
(MAPFONT D 0 (FONTNAME $cm))\
(MAPFONT D 1 (FONTNAME o${cm#c}))" $om.vpl
sed -i 's/^(CHARACTER O \([23][0-9][0-9]\)/&\n   (MAP\n      (SELECTFONT D 1)\n      (SETCHAR O \1)\n      )/' $om.vpl
cp ~/tex/TeXfonts/omtt10.tfm $cm.tfm # for vptovf
cp ~/tex/TeXfonts/omtt10.tfm o${cm#c}.tfm # for vptovf
vptovf $om.vpl
cp $om.vf ~/lhplain/vf/
ln -s ~/tex/TeXfonts/$om.tfm ~/lhplain/tfm/$cm.tfm
ln -s ~/tex/TeXfonts/$om.tfm ~/lhplain/tfm/o${cm#c}.tfm
done ###################################################################
